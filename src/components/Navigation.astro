---
import Container from "../design-system/Container.astro";
import Heading from "../design-system/Heading.astro";
import Text from "../design-system/Text.astro";
---

<header>
  <Container inset className="py-6 relative">
    <nav class="lg:flex lg:items-center">
      {/* Logo/Title - Always visible */}
      <div class="flex-1">
        <a href="/" class="hover:opacity-80">
          <Heading as="span" level="4">Life-centered Design</Heading><br />
          <Heading as="span" level="4"
            ><span style="font-weight: 400;">Collective</span>
          </Heading>
        </a>
      </div>

      {/* Mobile Menu Button */}
      <button
        id="menu-toggle"
        class="absolute top-6 right-4 p-2 rounded-lg hover:bg-gray-100 transition-colors z-[51] lg:hidden"
        aria-label="Toggle navigation menu"
      >
        <svg id="menu-icon" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path id="menu-open-icon" d="M3 12h18M3 6h18M3 18h18" />
          <path id="menu-close-icon" d="M18 6L6 18M6 6l12 12" class="hidden" />
        </svg>
      </button>

      {/* Desktop Navigation */}
      <ul class="hidden lg:flex gap-4 sm:gap-10 items-center">
        <li>
          <a href="/#about" class="hover:opacity-80">
            <Text>About us</Text>
          </a>
        </li>
        <li>
          <a href="/#principles" class="hover:opacity-80">
            <Text>Principles</Text>
          </a>
        </li>
        <li>
          <a href="/#case-study" class="hover:opacity-80">
            <Text>Study on LCD tools</Text>
          </a>
        </li>
        <li>
          <a href="/#team" class="hover:opacity-80">
            <Text>The Members</Text>
          </a>
        </li>
        <li>
          <a href="/#resources" class="hover:opacity-80">
            <Text weight="bold">Collective Resources</Text>
          </a>
        </li>
      </ul>

      {/* Mobile Menu Overlay */}
      <div id="mobile-menu" class="hidden fixed inset-0 bg-white/95 backdrop-blur-sm z-50 transition-opacity">
        <div class="container h-full flex flex-col items-center justify-center gap-8 text-center">
          <ul class="space-y-6 w-full px-4">
            <li class="text-center">
              <a href="/#about" class="text-2xl hover:opacity-80 block">About us</a>
            </li>
            <li class="text-center">
              <a href="/#principles" class="text-2xl hover:opacity-80 block">Principles</a>
            </li>
            <li class="text-center">
              <a href="/#case-study" class="text-2xl hover:opacity-80 block">Study on LCD tools</a>
            </li>
            <li class="text-center">
              <a href="/#team" class="text-2xl hover:opacity-80 block">The Members</a>
            </li>
            <li class="text-center">
              <a href="/#resources" class="text-2xl font-bold hover:opacity-80 block">Collective Resources</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </Container>

  <script is:inline>
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuOpenIcon = document.getElementById('menu-open-icon');
    const menuCloseIcon = document.getElementById('menu-close-icon');
    let isMenuOpen = false;

    function toggleMenu() {
      isMenuOpen = !isMenuOpen;
      mobileMenu.classList.toggle('hidden');
      menuOpenIcon.classList.toggle('hidden');
      menuCloseIcon.classList.toggle('hidden');
      document.body.style.overflow = isMenuOpen ? 'hidden' : 'auto';
      
      // Remove opacity transitions
      menuOpenIcon.style.opacity = '';
      menuCloseIcon.style.opacity = '';
    }

    function closeMenu() {
      if (isMenuOpen) {
        toggleMenu();
      }
    }

    // Toggle menu on button click
    menuToggle.addEventListener('click', toggleMenu);

    // Close menu on outside click
    mobileMenu.addEventListener('click', (e) => {
      if (e.target === mobileMenu) closeMenu();
    });

    // Close menu on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });

    // Close menu when clicking nav links
    mobileMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeMenu);
    });
  </script>

  <style is:global>
    #mobile-menu:not(.hidden) + #menu-toggle {
      display: block !important;
    }
    
    #mobile-menu {
      opacity: 0;
      transition: opacity 0.3s ease-out, transform 0.3s ease-out;
    }
    
    #mobile-menu:not(.hidden) {
      opacity: 1;
      animation: slideIn 0.3s ease-out forwards;
    }

    @keyframes slideIn {
      from {
        transform: translateY(-20px);
      }
      to {
        transform: translateY(0);
      }
    }

    @media (prefers-reduced-motion: reduce) {
      #mobile-menu {
        transition: none;
        animation: none;
      }
    }
  </style>
</header>
